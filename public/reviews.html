<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³ ê° í›„ê¸° - ì„ ìƒ¤ì¸íˆ¬ì–´</title>
    <meta name="description" content="ì„ ìƒ¤ì¸íˆ¬ì–´ì™€ í•¨ê»˜í•œ ê³ ê°ë“¤ì˜ ì†Œì¤‘í•œ í›„ê¸°ë¥¼ í™•ì¸í•˜ì„¸ìš”.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Noto+Serif+KR:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="/static/css/style.css" rel="stylesheet">
</head>
<body>
    <!-- Header & Navigation -->
    <header>
        <nav class="container">
            <div class="logo">
                <a href="/">â˜€ï¸ ì„ ìƒ¤ì¸íˆ¬ì–´</a>
            </div>
            <ul class="nav-links">
                <li class="nav-dropdown">
                    <a href="#destinations">ì—¬í–‰ì§€ <i class="fas fa-chevron-down"></i></a>
                    <div class="dropdown-content">
                        <a href="/destinations/thailand">ğŸ‡¹ğŸ‡­ íƒœêµ­</a>
                        <a href="/destinations/bali">ğŸ‡®ğŸ‡© ë°œë¦¬</a>
                        <a href="/destinations/maldives">ğŸ‡²ğŸ‡» ëª°ë””ë¸Œ</a>
                        <a href="/destinations/hawaii">ğŸ‡ºğŸ‡¸ í•˜ì™€ì´</a>
                        <a href="/destinations/philippines">ğŸ‡µğŸ‡­ í•„ë¦¬í•€</a>
                        <a href="/destinations/europe">ğŸ‡ªğŸ‡º ìœ ëŸ½</a>
                    </div>
                </li>
                <li><a href="/reviews">í›„ê¸°</a></li>
                <li><a href="/inquiry">ë¬¸ì˜í•˜ê¸°</a></li>
                <li><a href="/admin">ê´€ë¦¬ì</a></li>
            </ul>
            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </nav>
    </header>

    <!-- Reviews Header -->
    <section style="background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); padding: 4rem 0; color: white; text-align: center;">
        <div class="container">
            <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">ê³ ê° í›„ê¸°</h1>
            <p style="font-size: 1.2rem; margin-bottom: 2rem;">ì„ ìƒ¤ì¸íˆ¬ì–´ì™€ í•¨ê»˜í•œ í–‰ë³µí•œ ìˆœê°„ë“¤</p>
            <a href="/review-write" class="btn btn-secondary">í›„ê¸° ì‘ì„±í•˜ê¸°</a>
        </div>
    </section>

    <!-- Filter Section -->
    <section class="container" style="margin-top: 3rem;">
        <div style="background-color: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label">ì—¬í–‰ì§€ í•„í„°</label>
                    <select id="destination-filter" class="form-select">
                        <option value="">ì „ì²´</option>
                        <option value="thailand">íƒœêµ­</option>
                        <option value="bali">ë°œë¦¬</option>
                        <option value="maldives">ëª°ë””ë¸Œ</option>
                        <option value="hawaii">í•˜ì™€ì´</option>
                        <option value="philippines">í•„ë¦¬í•€</option>
                        <option value="europe">ìœ ëŸ½</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label">ë³„ì  í•„í„°</label>
                    <select id="rating-filter" class="form-select">
                        <option value="">ì „ì²´</option>
                        <option value="5">â­â­â­â­â­ (5ì )</option>
                        <option value="4">â­â­â­â­ (4ì  ì´ìƒ)</option>
                        <option value="3">â­â­â­ (3ì  ì´ìƒ)</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- Reviews Container -->
    <section class="container">
        <div id="reviews-container">
            <div class="loading">
                <div class="spinner"></div>
                <p>í›„ê¸°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer style="margin-top: 5rem;">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>ì„ ìƒ¤ì¸íˆ¬ì–´</h3>
                    <p>í”„ë¦¬ë¯¸ì—„ í—ˆë‹ˆë¬¸ & í•´ì™¸ ì—¬í–‰ ì „ë¬¸</p>
                    <p>20ë…„ ê²½ë ¥ì˜ ì „ë¬¸ê°€ê°€ ë§Œë“œëŠ” ì™„ë²½í•œ ì—¬í–‰</p>
                </div>
                <div class="footer-section">
                    <h3>ì—¬í–‰ì§€</h3>
                    <p><a href="/destinations/thailand">íƒœêµ­</a></p>
                    <p><a href="/destinations/bali">ë°œë¦¬</a></p>
                    <p><a href="/destinations/maldives">ëª°ë””ë¸Œ</a></p>
                    <p><a href="/destinations/hawaii">í•˜ì™€ì´</a></p>
                </div>
                <div class="footer-section">
                    <h3>ê³ ê° ì§€ì›</h3>
                    <p><a href="/reviews">ê³ ê° í›„ê¸°</a></p>
                    <p><a href="/inquiry">ë¬¸ì˜í•˜ê¸°</a></p>
                    <p><a href="/admin">ê´€ë¦¬ì</a></p>
                </div>
                <div class="footer-section">
                    <h3>ì—°ë½ì²˜</h3>
                    <p><i class="fas fa-phone"></i> 02-1234-5678</p>
                    <p><i class="fas fa-envelope"></i> info@sunshinetour.com</p>
                    <p><i class="fas fa-map-marker-alt"></i> ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ì„ ìƒ¤ì¸íˆ¬ì–´. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        const API_BASE = '/api';
        
        // í˜ì´ì§€ ë¡œë“œì‹œ í›„ê¸° ë¡œë“œ
        document.addEventListener('DOMContentLoaded', () => {
            loadReviews();
            
            // í•„í„° ì´ë²¤íŠ¸
            document.getElementById('destination-filter').addEventListener('change', loadReviews);
            document.getElementById('rating-filter').addEventListener('change', loadReviews);
            
            // ëª¨ë°”ì¼ ë©”ë‰´
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            const navLinks = document.querySelector('.nav-links');
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', () => {
                    navLinks.classList.toggle('active');
                });
            }
        });
        
        // í›„ê¸° ë¡œë“œ í•¨ìˆ˜
        async function loadReviews() {
            const container = document.getElementById('reviews-container');
            const destination = document.getElementById('destination-filter').value;
            const rating = document.getElementById('rating-filter').value;
            
            container.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>í›„ê¸°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                </div>
            `;
            
            try {
                let url = `${API_BASE}/reviews?status=approved`;
                if (destination) url += `&destination=${destination}`;
                
                const response = await fetch(url);
                const result = await response.json();
                
                if (result.success && result.data.length > 0) {
                    // ë³„ì  í•„í„° ì ìš©
                    let reviews = result.data;
                    if (rating) {
                        const minRating = parseInt(rating);
                        reviews = reviews.filter(r => r.rating >= minRating);
                    }
                    
                    if (reviews.length === 0) {
                        container.innerHTML = `
                            <div style="text-align: center; padding: 3rem; color: var(--text-light);">
                                <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                                <p>ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” í›„ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                            </div>
                        `;
                        return;
                    }
                    
                    container.innerHTML = `
                        <div class="card-grid">
                            ${reviews.map(review => createReviewCard(review)).join('')}
                        </div>
                    `;
                } else {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 3rem; color: var(--text-light);">
                            <i class="fas fa-comments" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <p>ì•„ì§ ë“±ë¡ëœ í›„ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                            <a href="/review-write" class="btn btn-primary" style="margin-top: 1rem;">ì²« í›„ê¸° ì‘ì„±í•˜ê¸°</a>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading reviews:', error);
                container.innerHTML = `
                    <div class="error-message">
                        í›„ê¸°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
                    </div>
                `;
            }
        }
        
        // í›„ê¸° ì¹´ë“œ ìƒì„±
        function createReviewCard(review) {
            const stars = 'â­'.repeat(review.rating);
            const imageHtml = review.image_url 
                ? `<img src="${review.image_url}" alt="${escapeHtml(review.title)}" class="card-image" onerror="this.style.display='none'">` 
                : '';
            
            return `
                <div class="card">
                    ${imageHtml}
                    <div class="card-content">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <div class="review-rating">${stars}</div>
                            <span style="background-color: var(--primary-color); color: white; padding: 0.3rem 0.8rem; border-radius: 50px; font-size: 0.85rem;">${escapeHtml(review.destination_kr)}</span>
                        </div>
                        <h3 class="card-title">${escapeHtml(review.title)}</h3>
                        <p class="card-description">${escapeHtml(review.content.substring(0, 150))}${review.content.length > 150 ? '...' : ''}</p>
                        <div class="review-meta">
                            <span><i class="fas fa-user"></i> ${escapeHtml(review.author_name)}</span>
                            <span><i class="fas fa-calendar"></i> ${escapeHtml(review.travel_date)}</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // HTML ì´ìŠ¤ì¼€ì´í”„
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return String(text).replace(/[&<>"']/g, m => map[m]);
        }
    </script>
</body>
</html>
